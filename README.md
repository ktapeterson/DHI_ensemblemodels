DHI_ensemblemodels

Metadata for code assosciated with Peterson, K., Barnes, M., Jeynes Smith, C., Baker, C., Gibson, L., Sims, C., Cowen, S., Bode, M. (2021). Reconstructing the historical fauna of a large continental island: a multispecies reintroduction risk analysis. Journal of Applied Ecology.

Methods: 
This is the code and data that generates the models and figures used in the manuscript and supplementary documents. 

We begin by generating an ensemble of models for each transition matrix, which are associated with the same dynamic behaviours determined through expert elicitation. To do this we first determine a scalar multiple for each transition matrix, that will be multiplied along the diagonal of the coefficient matrix and ensure that one thousand models are generated in approximately 24 hours. This is done using the Matlab script FindMultiplier.m in which a user selects the transition matrix to investigate (and its type: 1 if all signs are defined, 2 if the sign is uncertain). 

The ensemble of models is then generated using the Matlab script CreateModelsForAll.m. This script requires the user to define the transition matrix to investigate and the number of models which we want to generate. The user must also change the save name at the bottom of the script. This script uses Multipliers.mat (generated by the user by running FindMultiplier.m), IM’X’.xlsx, where ‘X’∈{1,…,7}, and Rvector.xlsx. This script also uses the functions and scripts ExtractCoexistenceConstraints.m, Coexistence_constraint.m, check_stability.m, and GrowthRateConstraint.m, which are used to determine if models match the elicited dynamic constraints. We will discuss these constraints in more detail later. Finally this script outputs ModelEnsembleIM’X’.mat, where ‘X’∈{1,…,7}, which contains the ensemble of models (and their associated parameters) for interaction matrix ‘X’. 

Finally, we use the ensemble of models to simulate the reintroduction strategies. This is done using the script, Spatial_reintroduction_simulation.m. This script uses ModelEnsembleIM’X’.mat, where ‘X’∈{1,…,7}, along with elicited dispersal data in DispTimeDelay.xlsx, DispUpperBound.xlsx, DispLowerBound.xlsx. The translocation strategies are loaded in using AlternativeNames.xlsx, and Alt’Y’.xlsx, where ‘Y’∈{1,…,23}. This script then uses species_DE_spatial.m to simulate the system. The output of Spatial_reintroduction_simulation.m saves OutcomesSetBIGIM’X’.mat (the set of species which failed in a given simulation for a given translocation alternative), and SimulationSetBIGIM’X’.mat (the timeseries abundance and time data for every simulation), where ‘X’∈{1,…,7}. 

To then analyse these simulations and generate the figures used in the manuscript and supplementary materials we use the following scripts and functions:

Manuscript Figures:

Fig 2: VisuallyCompareMatrices.m
Fig 3: Figure_key_timeseries_SUBSET.m
Fig 4: Figure_4.m
Fig 5: ExplainWhyExtinct_quantiles.m
Fig 6: Figure_checkerboard_particular_species.m
Supplementary Figures
Supplementary Information 2: SUPPFIG_Figure_key_timeseries_AllSupps.m 
Supplementary Information 3: SUPPFIG_matrix_violins.m 
Supplementary Information 4: SUPPFIG_Figure_checkerboards_bars.m 
Supplementary Information 5: ExplainWhyExtinct_quantiles.m
Input parameters are specified at the beginning of major scripts/functions.

Usage Notes:
We provide a summary of all functions with their inputs, dependent functions/data, and outputs. 

To generate models:

FindMultiplier.m
Determines the diagonal multiplier ‘FinalMult’ for a given transition matrix, IM’X’.xlsx, to generate 1000 samples in approximately 24 hours when used in CreateModelsForAll.m.  
Inputs: Select a transition matrix, IM’X’.xlsx, to investigate (and its type: 1 if all signs are defined, 2 if there is sign uncertainty), 
Loads Rvector.xlsx, IM’X’.xlsx
Runs ExtractCoexistenceConstraint.m, Coexistence_constraint.m, check_stability.m, GrowthRateConstraint.m

CreateModelsForAll.m
Finds models which meet dynamic constraints for a selected transition matrix.
Inputs: select transition matrix, IM’X’.xlsx, to investigate (and its type: 1 if all signs are defined, 2 if there is sign is uncertain) and number of coexisting matrices which we want. Change output save name at the bottom of the file
Loads Multipliers.mat, IM’X’.xlsx, Rvector.xlsx, Coexistence_constraints_list.mat
Runs Coexistence_constraint.m, check_stability.m, GrowthRateConstraint.m, ExtractCoexistenceConstraints.m
Saves ModelEnsembleIM’X’.mat

Spatial_reintroduction_simulation.m
This generates simulations of the ecosystems which are then used to generate figures 
Loads in DispTimeDelay.xlsx, DispUpperBound.xlsx, DispLowerBound.xlsx, AlternativeNames.xlsx, AltX.xlsx, ModelEnsembleIMX.mat,
Runs species_DE_spatial.m
Saves OutcomesSetBIGIMX.mat, SimulationSetBIGIMX.mat

ExtractCoexistenceConstraints.m
Generates a matrix with abundance constraints
Loads Coexistence_constraints_CS_SC.xlsx
Saves Coexistence_constraints_list.mat

Check_stability.m
Checks the stability of a system
Is run by CreateModelsForAll.m and Coexistence_constraint.m

Coexistence_constraint.m
Checks if a subset of species can coexist together
Runs Check_stability.m
Is run by CreateModelsForAll.m

GrowthRateConstraint.m
Checks if species have growth rates which exist within the bounds identified by Rvector.xlsx
Is run by CreateModelsForAll.m

species_DE_spatial.m
Runs a simulation of a translocation strategy, taking into account spatial factors such as translocation 
is run by Spatial_reintroduction_simulation.m
Manuscript Figures:

Fig 2: VisuallyCompareMatrices.m
Input: Change ‘i’ to range from 1:6 to 1:7 (line 53) to obtain all Figures found in manuscript
Loads DHINames.xlsx, DHINames_short.xlsx, DHINames_medium.xlsx, IM’X’.mat, 

Fig 3: Figure_key_timeseries_SUBSET.m
Loads AlternativeNames_23.xlsx, SimulationSetBIGIMX.mat, OutcomesSetBIGIMX.mat, DHINames.xlsx
Calls Make_TIFF.m, tight_subplot.m
Saves Reintro_timeseries_LowRes.tiff, Reintro_timeseries.tiff

Fig 4: Figure_4.m
Loads AlternativeNames_23.xlsx, OutcomesSetBIGIMX.mat, DHINames.xlsx, OUTCOMES_BLOCK.mat  
Calls TranslocationAlternativesNames.m, Make_TIFF.m
Saves Figure_4_LowRes.tiff, Figure_4.tiff

Fig 5: ExplainWhyExtinct_quantiles.m
Loads ModelEnsembleIMX.mat, OutcomesSetBIGIMX.mat, SimulationSetBIGIMX.mat, DHINames.xlsx, DHINames_short.xlsx, DHINames_medium.xlsx, AlternativeNames_23.xlsx
Calls Make_TIFF.m
Saves ‘SpeciesName’_failure_ExpertMatrix_’X’.tiff

Fig 6: Figure_checkerboard_particular_species.m
Loads AlternativeNames_23.xlsx, OutcomesSetBIGIMX.mat, DHINames.xlsx, DHINames_short.xlsx, DHINames_medium.xlsx
Calls TranslocationAlternativesNames.m, Make_TIFF.m, tight_subplot.m
Figure_6_LowRes.tiff, Figure_6.tiff
ManuscriptFigure_checkerboards_bars_consensus.m: 
Input: set variable PLOT_checker_SameMat = 1
Loads AlternativeNames_23.xlsx, OutcomesSetBIGIM’X’.mat, DHINames_short.xlsx, DHINames_medium.xlsx
Saves OUTCOMES_BLOCK.mat which is used in Figure_4.m
TranslocationAlternativesNames.m:
Input: ALTNAME (defined in functions which call it)
Loads ALTNAME.xlsx
Defines the names used in figures

Supplementary Figures

Supplementary Information 2: SUPPFIG_Figure_key_timeseries_AllSupps.m
Loads AlternativeNames_23.xlsx, SimulationSetBIGIMX.mat, OutcomesSetBIGIMX.mat, DHINames.xlsx, DHINames_short.xlsx
Calls Make_TIFF.m, tight_subplot.m
Saves SuppFig_Reintro_timeseries_X.tiff

Supplementary Information 3: SUPPFIG_matrix_violins.m
Loads AlternativeNames_23.xlsx, OutcomesSetBIGIMX.mat, DHINames.xlsx, 
Calls Make_TIFF.m, TranslocationAlternativesNames.m
Saves SuppFig_violin_X.tiff

Supplementary Information 4: SUPPFIG_Figure_checkerboards_bars.m
Loads AlternativeNames_23.xlsx, OutcomesSetBIGIMX.mat, DHINames.xlsx, DHINames_short.xlsx, DHINames_medium.xlsx
INPUT: PLOT_checker_SameSpp, PLOT_checker_SameAlt, PLOT_checker_SameMat are binary variables at the top of the file, which are set to 1 if the desired figure is to be generated
Calls TranslocationAlternativesNames.m, Make_TIFF.m, tight_subplot.m
Saves SuppFig_MatrixAlternativeChecquerboard.tiff, SuppFig_MatrixSpeciesChecquerboard.tiff, SuppFig_AlternativeSpeciesChecquerboard.tiff

Supplementary Information 5: ExplainWhyExtinct_quantiles.m
Loads ModelEnsembleIMX.mat, OutcomesSetBIGIMX.mat, SimulationSetBIGIMX.mat, DHINames.xlsx, DHINames_short.xlsx, DHINames_medium.xlsx, 
AlternativeNames_23.xlsx
Calls Make_TIFF.m
Saves ‘SpeciesName’_failure_ExpertMatrix_’X’.tiff 

External Function:
tight_subplot.m: 
generates subplots with minimised whitespace.

Downloaded from MathWorks 


If you have questions, please contact kpeter10@sesync.org, cailan.jeynessmith@hdr.qut.edu.au,  or michael.bode@qut.edu.au
